<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Geek Brunch SG</title>
<!-- metacrap -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@geekbrunchsg">
<meta name="twitter:url" property="og:url" content="https://geekbrunch.sg/">
<meta name="twitter:title" property="og:title" content="Geek Brunch SG">
<meta name="twitter:description" property="og:description" content="A biannual social gathering for all engineers, designers and makers in Singapore.">
<meta name="twitter:image" property="og:image" content="https://geekbrunch.sg/background.jpg">
<!-- end metacrap -->
<link rel="icon" href="favicon.png" type="image/png">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arvo">
<style>
html{
  min-height: 100%;
  background: linear-gradient(rgba(0,0,0,.65), rgba(0,0,0,.65)), url(background.jpg) center no-repeat;
  background-size: cover;
  display: flex;
}
body{
  font-family: Arvo, sans-serif;
  max-width: 25em;
  padding: 10px;
  margin: auto;
  text-align: center;
  color: #fff;
  line-height: 1.5em;
  text-shadow: 0 1px #000;
}
a{
  color: #fff;
}
a.button{
  display: inline-block;
  border: 1px solid #fff;
  border-radius: 1em;
  padding: .5em 2em;
  text-decoration: none;
  transition: .3s background-color;
  font-size: 150%;
}
a.button:hover, a.button:active{
  background-color: rgba(255,255,255,.25);
}
footer{
  margin-top: 5em;
  font-size: .8em;
  opacity: .7;
  transition: .3s opacity;
}
footer:hover{
  opacity: 1;
}
</style>
<h1>Geek Brunch SG</h1>
<p>A biannual social gathering for all engineers, designers and makers in&nbsp;Singapore.</p>
<p>Come down and have a brunch.<br>Bring someone new, someone&nbsp;curious.</p>
<div id="event-details">
</div>
<p><a class="button" href="https://www.facebook.com/events/663549580471268/">Join us!</a></p>
<footer>
  Jointly organised by
  <br>
  <a href="https://webuild.sg/">We Build SG</a>, <a href="https://engineers.sg/">Engineers.SG</a> &amp; <a href="https://kopijs.org/">Kopi.JS</a>.
  <br>
  <a href="https://medium.com/we-build-sg/the-story-of-geek-brunch-singapore-943c3c99515f">Read the story</a>.
</footer>
<div id="debug"></div>
<script src="https://unpkg.com/date-format-lite@0.9.1/dist/index-min.js"></script>
<script>
var $eventDetails = document.getElementById('event-details');
function tzDate(d, offset){ // date object, timezone offset in minutes
  var offsetLocal = d.getTimezoneOffset();
  var diff = (offset - offsetLocal) * 60000;
  return new Date((+d) + diff);
};

// Because Safari doesn't support `fetch`
var xhr = new XMLHttpRequest();
xhr.onload = function(){
  var data = JSON.parse(this.responseText);
  var date = new Date(data.start_time.replace(/(\d{2})(\d{2})$/, '$1:$2'));
  var offsetDate = tzDate(date, -480); // +08:00
  $eventDetails.innerHTML = '<p>ðŸ—“ '
      + offsetDate.format('DDDD MMM D @ H:mm A')
    + '<br>ðŸ—º '
      + data.place.name + ', ' + data.place.location.city
    + '</p>';
};
xhr.open('GET', 'https://graph.facebook.com/v2.8/663549580471268?access_token=217930538571201%7C1jrJldK0NmvpP1q4SXtv_5oMcoU');
xhr.send();

var midPoint = 50, range = 20, prevLeft = 50;
window.addEventListener('deviceorientation', function(e){
  var side = window.orientation == 0 ? 'gamma' /* portrait */ : 'beta' /* landscape */;
  var rot = Math.max(-range, Math.min(range, e[side]));
  var left = midPoint - midPoint/range*rot;
  var fixedLeft = Math.round(left/2) * 2;
  if (Math.abs(fixedLeft - prevLeft) > 50) return; // Ignore sudden jumps
  prevLeft = fixedLeft;
  // document.getElementById('debug').innerHTML = left + ' ' + prevLeft;
  document.documentElement.style.backgroundPosition = fixedLeft + '% center';
});
</script>
